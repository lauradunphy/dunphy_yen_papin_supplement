# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)
Figure4Jitter
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(fill = strain, size = 2))
Figure4Jitter
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain, size = 2),position = position_jitter(w = 0.4, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain, size = 1),position = position_jitter(w = 0.25, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain, size = 2),position = position_jitter(w = 0.4, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain, size = 2),position = position_jitter(w = 0.4, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain, size = 1),position = position_jitter(w = 0.25, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain, size = 0.5),position = position_jitter(w = 0.25, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain, size = 0.25),position = position_jitter(w = 0.25, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain, size = 0.25),position = position_jitter(w = 0.35, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter
Figure4Jitter <- growthDatGlcNAcMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
# geom_point(aes(color = strain))+
# geom_dotplot(aes(fill = strain),
#              binaxis = "y",
#              stackdir = "center")+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
# geom_pointrange(mapping = aes(x = strain, y = maxOD600),
# stat = "summary",
# fun.ymin = function(z) {quantile(z,0.25)},
# fun.ymax = function(z) {quantile(z,0.75)},
# fun.y = median)+
geom_signif(comparisons=list(c("Day0Anc", "Day20T4"), c("Day0Anc","nuoL")), annotations=c("*","*"), tip_length = 0, y_position = c(0.12,0.14))+
facet_wrap(~media)+
ylab("Max Growth (OD600)")+ylim(0,0.15)+
scale_color_manual(values =c('grey','dodgerblue2','green2'),breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant')))) +
theme_bw()+theme(legend.position = 'none',strip.background = element_rect(fill='white'), axis.title.x = element_blank(), axis.text.x = element_text(angle=45, hjust=1))+
scale_x_discrete(breaks=c("Day0Anc","Day20T4","nuoL"),labels=c("Ancestor","TOB*",expression(paste(italic('nuoL'),' mutant'))))
Figure4Jitter
# 6C Data Biological replicates 1-4 of ancestor, PIP and gnyA grown in 40mM L-leucine
ancP1gnyAGrowthRaw <- read_csv("growthDataLeucine.csv")
# All 4 replicates of Leucine/Isoleucne Anc/Pip/gnyA for figure 6C
ancP1gnyAGrowthAllReps <- ancP1gnyAGrowthRaw %>% group_by(strain,wellID, media, timeTidy) %>%
summarise(OD600 = median(data)) # CHANGED THIS TO MEDIAN
# Calculate the distribution of optical maximum densities:
# 1. Subtract the minimum OD600 from each isolate curve from the entire curve
ancP1gnyAMinimums <- ancP1gnyAGrowthAllReps %>% ungroup() %>% group_by(strain, wellID, media) %>% filter(media == 'L-Leucine') %>% summarise(minOD600 = min(OD600))
ancP1gnyAMinimums <- do.call("rbind", replicate(272, ancP1gnyAMinimums, simplify = FALSE))
ancP1gnyAMinimums <- ancP1gnyAMinimums %>% arrange(wellID)
ancP1gnyAGrowthLeucine <- ancP1gnyAGrowthAllReps %>% filter(media == 'L-Leucine')
ancP1gnyAGrowthLeucine$minSubtractedOD600 <- ancP1gnyAGrowthLeucine$OD600 - ancP1gnyAMinimums$minOD600
# 2. Take the maximum of each min-subtracted isolate curve (stats calculated from this)
ancP1gnyAMaximums <- ancP1gnyAGrowthLeucine %>% ungroup() %>% group_by(strain, wellID, media) %>% summarise(maxOD600 = max(minSubtractedOD600)) %>% filter(strain != 'blank')
# 3. Calculate median and IQR of each strain (used for plotting Fig 6C)
ancP1gnyADistribution <- ancP1gnyAMaximums %>%
ungroup() %>% group_by(strain, media) %>% summarise(medianMaxOD600 = median(maxOD600), IQ25 = quantile(maxOD600, 1/4), IQ75 = quantile(maxOD600, 3/4))
ancP1gnyADistribution$strain <- factor(ancP1gnyADistribution$strain, levels=c('Day0Anc','Day20P1','gnyA','blank'))
#### NEED TO ADJUST FIGURE
# Background subtract and calculate median + IQR for growth curves (Fig S6)
ancP1gnyAGrowth <- ancP1gnyAGrowthAllReps %>%
ungroup() %>% group_by(strain, media, timeTidy) %>% summarise(medianOD600 = median(OD600), IQ25 = quantile(OD600, 1/4), IQ75 = quantile(OD600,3/4))
# All 4 replicates of Leucine/Isoleucine Anc/Pip/gnyA for Figure 6C after blank background subtraction
ancP1gnyANegControl <- ancP1gnyAGrowth %>% filter(strain == 'blank')
ancP1gnyANegControl <- do.call("rbind", replicate(7, ancP1gnyANegControl, simplify = FALSE))
ancP1gnyAGrowth$AUCmedian <- ancP1gnyAGrowth$medianOD600 - ancP1gnyANegControl$medianOD600
ancP1gnyAGrowth$IQ25 <- ancP1gnyAGrowth$IQ25 - ancP1gnyANegControl$medianOD600
ancP1gnyAGrowth$IQ75 <- ancP1gnyAGrowth$IQ75 - ancP1gnyANegControl$medianOD600
ancP1gnyAGrowth$strain <- factor(ancP1gnyAGrowth$strain, levels=c('Day0Anc','Day20P1','gnyA','blank'))
### 6D Data Biological Replicates 1+2 and 3+4 of scoA/scoB on 4HBA
ancP1scoAB1 <- read_csv("growthData4HBA_1.csv")
ancP1scoAB2 <- read_csv("growthData4HBA_2.csv")
# Merge all 4 replicates on 4HBA together:
ancP1scoAB12 <- rbind(ancP1scoAB1,ancP1scoAB2)
ancP1scoAB12_AllReps <- ancP1scoAB12 %>% filter(media == '4-Hydroxybenzoic Acid') %>% group_by(strain, wellID, media, timeTidy) %>% summarise(OD600 = median(data)) #CHANGED TO MEDIAN
# Calculate the distribution of optical maximum densities:
# 1. Subtract the minimum OD600 from each isolate curve from the entire curve
ancP1scoABMinimums <- ancP1scoAB12_AllReps %>% ungroup() %>% group_by(strain, wellID, media) %>% filter(media == '4-Hydroxybenzoic Acid') %>% summarise(minOD600 = min(OD600))
ancP1scoA2Minimums <- do.call("rbind", replicate(272, ancP1scoABMinimums, simplify = FALSE))
ancP1scoABMinimums <- ancP1scoABMinimums %>% arrange(wellID)
ancP1scoAB12_AllReps$minSubtractedOD600 <- ancP1scoAB12_AllReps$OD600 - ancP1scoABMinimums$minOD600
# 2. Take the maximum of each min-subtracted isolate curve (stats calculated from this)
ancP1scoABMaximums <- ancP1scoAB12_AllReps %>% ungroup() %>% group_by(strain, wellID, media) %>% summarise(maxOD600 = max(minSubtractedOD600)) %>% filter(strain != 'blank')
# 3. Calculate median and IQR of each strain (used for plotting Fig 6D)
ancP1scoABDistribution <- ancP1scoABMaximums %>%
ungroup() %>% group_by(strain, media) %>% summarise(medianMaxOD600 = median(maxOD600), IQ25 = quantile(maxOD600, 1/4), IQ75 = quantile(maxOD600, 3/4))
ancP1scoABDistribution$strain <- factor(ancP1scoABDistribution$strain, levels=c('Day0Anc','Day20P1','scoA','scoB','blank'))
#### NEED TO ADJUST FIGURE
# Background subtract and calculate median + IQR for growth curves (Fig S6)
ancP1scoABGrowth <- ancP1scoAB12_AllReps %>% ungroup() %>% group_by(strain, media, timeTidy) %>% summarise(medianOD600 = median(OD600), IQ25 = quantile(OD600, 1/4), IQ75 = quantile(OD600, 3/4))
# All 4 replicates on 4HBA after blank background subtraction:
ancP1scoABNegControl <- ancP1scoABGrowth %>% filter(strain =='blank')
ancP1scoABNegControl <- do.call("rbind",replicate(5,ancP1scoABNegControl,simplify = FALSE))
ancP1scoABGrowth$AUCmedian <- ancP1scoABGrowth$medianOD600 - ancP1scoABNegControl$medianOD600
ancP1scoABGrowth$IQ25 <- ancP1scoABGrowth$IQ25 - ancP1scoABNegControl$medianOD600
ancP1scoABGrowth$IQ75 <- ancP1scoABGrowth$IQ75 - ancP1scoABNegControl$medianOD600
ancP1scoABGrowth$strain <- factor(ancP1scoABGrowth$strain, levels=c('Day0Anc','Day20P1','scoA','scoB','blank'))
Fig6C <- ancP1gnyAMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1")), annotations=c("*"), tip_length = 0, y_position = c(0.375))+
facet_wrap(~media)+
scale_y_continuous(limits = c(-0.01,0.4))+
scale_fill_manual(values=c('grey','red','goldenrod1','darkorange1'), breaks = c("Day0Anc","Day20P1","scoA","scoB"), labels=c('Ancestor','PIP',expression(paste(italic('scoA'),' mutant')), expression(paste(italic('scoB'),' mutant'))))+
ylab("Max Growth (OD600)")+
theme_bw()+
theme(legend.position = 'none', strip.background = element_rect(fill='white'), axis.text.x = element_text(angle = 45, hjust = 1), axis.title.x=element_blank())+
scale_x_discrete(breaks = c("Day0Anc","Day20P1","scoA","scoB"), labels=c('Ancestor','PIP',expression(paste(italic('scoA'),' mutant')), expression(paste(italic('scoB'),' mutant'))))
Fig6C
Fig6C <- ancP1gnyAMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1"), c("Day0Anc","gnyA")), annotations=c("*","*"), tip_length = 0, y_position = c(0.055,0.062))+
facet_wrap(~media)+theme_bw()+theme(legend.position = 'none', strip.background = element_rect(fill = 'white'),axis.text.x = element_text(angle = 45, hjust = 1),axis.title.x = element_blank())+
scale_fill_manual(values = c('grey','red', 'orange'),breaks=c("Day0Anc","Day20P1", "gnyA"),labels=c('Ancestor','PIP',expression(paste(italic('gnyA'),' mutant'))))+
ylab("Max Growth (OD600)")+ylim(-0.001,0.065)+
scale_x_discrete(breaks=c("Day0Anc","Day20P1","gnyA"),
labels=c("Ancestor", "PIP", expression(paste(italic('gnyA'),' mutant'))))
Fig6C
Fig6C <- ancP1gnyAMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1"), c("Day0Anc","gnyA")), annotations=c("*","*"), tip_length = 0, y_position = c(0.055,0.062))+
facet_wrap(~media)+theme_bw()+theme(legend.position = 'none', strip.background = element_rect(fill = 'white'),axis.text.x = element_text(angle = 45, hjust = 1),axis.title.x = element_blank())+
scale_color_manual(values = c('grey','red', 'orange'),breaks=c("Day0Anc","Day20P1", "gnyA"),labels=c('Ancestor','PIP',expression(paste(italic('gnyA'),' mutant'))))+
ylab("Max Growth (OD600)")+ylim(-0.001,0.065)+
scale_x_discrete(breaks=c("Day0Anc","Day20P1","gnyA"),
labels=c("Ancestor", "PIP", expression(paste(italic('gnyA'),' mutant'))))
Fig6C
Fig6C <- ancP1gnyAMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1"), c("Day0Anc","gnyA")), annotations=c("*","*"), tip_length = 0, y_position = c(0.055,0.062))+
facet_wrap(~media)+theme_bw()+theme(legend.position = 'none', strip.background = element_rect(fill = 'white'),axis.text.x = element_text(angle = 45, hjust = 1),axis.title.x = element_blank())+
scale_color_manual(values = c('grey','red', 'orange'),breaks=c("Day0Anc","Day20P1", "gnyA"),labels=c('Ancestor','PIP',expression(paste(italic('gnyA'),' mutant'))))+
ylab("Max Growth (OD600)")+ylim(-0.003,0.065)+
scale_x_discrete(breaks=c("Day0Anc","Day20P1","gnyA"),
labels=c("Ancestor", "PIP", expression(paste(italic('gnyA'),' mutant'))))
Fig6C
Fig6C <- ancP1gnyAMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1"), c("Day0Anc","gnyA")), annotations=c("*","*"), tip_length = 0, y_position = c(0.055,0.062))+
facet_wrap(~media)+theme_bw()+theme(legend.position = 'none', strip.background = element_rect(fill = 'white'),axis.text.x = element_text(angle = 45, hjust = 1),axis.title.x = element_blank())+
scale_color_manual(values = c('grey','red', 'orange'),breaks=c("Day0Anc","Day20P1", "gnyA"),labels=c('Ancestor','PIP',expression(paste(italic('gnyA'),' mutant'))))+
ylab("Max Growth (OD600)")+ylim(-0.001,0.08)+
scale_x_discrete(breaks=c("Day0Anc","Day20P1","gnyA"),
labels=c("Ancestor", "PIP", expression(paste(italic('gnyA'),' mutant'))))
Fig6C
Fig6C <- ancP1gnyAMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1"), c("Day0Anc","gnyA")), annotations=c("*","*"), tip_length = 0, y_position = c(0.082,0.092))+
facet_wrap(~media)+theme_bw()+theme(legend.position = 'none', strip.background = element_rect(fill = 'white'),axis.text.x = element_text(angle = 45, hjust = 1),axis.title.x = element_blank())+
scale_color_manual(values = c('grey','red', 'orange'),breaks=c("Day0Anc","Day20P1", "gnyA"),labels=c('Ancestor','PIP',expression(paste(italic('gnyA'),' mutant'))))+
ylab("Max Growth (OD600)")+ylim(-0.001,0.10)+
scale_x_discrete(breaks=c("Day0Anc","Day20P1","gnyA"),
labels=c("Ancestor", "PIP", expression(paste(italic('gnyA'),' mutant'))))
Fig6C
Fig6C <- ancP1gnyAMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1"), c("Day0Anc","gnyA")), annotations=c("*","*"), tip_length = 0, y_position = c(0.083,0.092))+
facet_wrap(~media)+theme_bw()+theme(legend.position = 'none', strip.background = element_rect(fill = 'white'),axis.text.x = element_text(angle = 45, hjust = 1),axis.title.x = element_blank())+
scale_color_manual(values = c('grey','red', 'orange'),breaks=c("Day0Anc","Day20P1", "gnyA"),labels=c('Ancestor','PIP',expression(paste(italic('gnyA'),' mutant'))))+
ylab("Max Growth (OD600)")+ylim(-0.001,0.10)+
scale_x_discrete(breaks=c("Day0Anc","Day20P1","gnyA"),
labels=c("Ancestor", "PIP", expression(paste(italic('gnyA'),' mutant'))))
Fig6C
Fig6C <- ancP1gnyAMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1"), c("Day0Anc","gnyA")), annotations=c("*","*"), tip_length = 0, y_position = c(0.083,0.092))+
facet_wrap(~media)+theme_bw()+theme(legend.position = 'none', strip.background = element_rect(fill = 'white'),axis.text.x = element_text(angle = 45, hjust = 1),axis.title.x = element_blank())+
scale_color_manual(values = c('grey','red', 'orange'),breaks=c("Day0Anc","Day20P1", "gnyA"),labels=c('Ancestor','PIP',expression(paste(italic('gnyA'),' mutant'))))+
ylab("Max Growth (OD600)")+ylim(-0.001,0.098)+
scale_x_discrete(breaks=c("Day0Anc","Day20P1","gnyA"),
labels=c("Ancestor", "PIP", expression(paste(italic('gnyA'),' mutant'))))
Fig6C
Fig6C2 <- ancP1gnyADistribution %>%
group_by(strain, media) %>%
ggplot(aes(strain, medianMaxOD600))+
geom_col(aes(fill = strain))+
geom_errorbar(aes(ymin = IQ25, ymax = IQ75), width = 0.2)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1"), c("Day0Anc","gnyA")), annotations=c("*","*"), tip_length = 0, y_position = c(0.055,0.062))+
facet_wrap(~media)+theme_bw()+theme(legend.position = 'none', strip.background = element_rect(fill = 'white'),axis.text.x = element_text(angle = 45, hjust = 1),axis.title.x = element_blank())+
scale_fill_manual(values = c('grey','red', 'orange'),breaks=c("Day0Anc","Day20P1", "gnyA"),labels=c('Ancestor','PIP',expression(paste(italic('gnyA'),' mutant'))))+
ylab("Max Growth (OD600)")+ylim(-0.001,0.065)+
scale_x_discrete(breaks=c("Day0Anc","Day20P1","gnyA"),
labels=c("Ancestor", "PIP", expression(paste(italic('gnyA'),' mutant'))))
Fig6C2
View(ancP1gnyAMaximums)
Fig6D <- ancP1scoABMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1")), annotations=c("*"), tip_length = 0, y_position = c(0.375))+
facet_wrap(~media)+
scale_y_continuous(limits = c(-0.01,0.4))+
scale_fill_manual(values=c('grey','red','goldenrod1','darkorange1'), breaks = c("Day0Anc","Day20P1","scoA","scoB"), labels=c('Ancestor','PIP',expression(paste(italic('scoA'),' mutant')), expression(paste(italic('scoB'),' mutant'))))+
ylab("Max Growth (OD600)")+
theme_bw()+
theme(legend.position = 'none', strip.background = element_rect(fill='white'), axis.text.x = element_text(angle = 45, hjust = 1), axis.title.x=element_blank())+
scale_x_discrete(breaks = c("Day0Anc","Day20P1","scoA","scoB"), labels=c('Ancestor','PIP',expression(paste(italic('scoA'),' mutant')), expression(paste(italic('scoB'),' mutant'))))
Fig6D
Fig6D <- ancP1scoABMaximums %>% group_by(strain) %>%
ggplot(aes(strain, maxOD600))+
geom_point(aes(color = strain),position = position_jitter(w = 0.35, h = 0))+
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.2)+
geom_errorbar(stat = "summary",
fun.ymin = function(z) {quantile(z,0.25)},
fun.ymax = function(z) {quantile(z,0.75)},
fun.y = median,
width = 0.1, size = 1)+
geom_signif(comparisons=list(c("Day0Anc", "Day20P1")), annotations=c("*"), tip_length = 0, y_position = c(0.375))+
facet_wrap(~media)+
scale_y_continuous(limits = c(-0.01,0.4))+
scale_color_manual(values=c('grey','red','goldenrod1','darkorange1'), breaks = c("Day0Anc","Day20P1","scoA","scoB"), labels=c('Ancestor','PIP',expression(paste(italic('scoA'),' mutant')), expression(paste(italic('scoB'),' mutant'))))+
ylab("Max Growth (OD600)")+
theme_bw()+
theme(legend.position = 'none', strip.background = element_rect(fill='white'), axis.text.x = element_text(angle = 45, hjust = 1), axis.title.x=element_blank())+
scale_x_discrete(breaks = c("Day0Anc","Day20P1","scoA","scoB"), labels=c('Ancestor','PIP',expression(paste(italic('scoA'),' mutant')), expression(paste(italic('scoB'),' mutant'))))
Fig6D
