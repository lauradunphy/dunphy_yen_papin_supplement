theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(0,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.635+0.001),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(1,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.635+0.001),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.5,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.635),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.25,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
biologAllGrowth <- biologAllStats %>%
group_by(strain,carbonSource) %>%
mutate(AUCsum = sum(AUCmedian)) %>% #changed this to median
filter(AUCsum>=growthCutoff) %>%
ungroup() %>% group_by(carbonSource,timePoint) %>%
mutate(numStrains=n()) %>%
filter(numStrains==5) %>%
ungroup() %>% group_by(strain, carbonSource) %>%
summarise(maxOD600=max(AUCmedian))
#Join these carbon sources with growth dynamics (growth rate and lag phase) to filter down their data frames
biologAllGrowthDynamics <- inner_join(biologAllGrowth, biologGrowthDynamicsStats)
biologAllGrowthDynamics <- inner_join(biologAllGrowthDynamics, biologMedianMaxOD600)
# biologAllGrowthDynamics$carbonSource <- factor(biologAllGrowthDynamics$carbonSource, levels = rev(unique(biologAllGrowthDynamics$carbonSource)),ordered = TRUE)
# Load descriptors for these carbon sources
Fig3_CarbonSourceDescriptors <- read_csv('carbonSourceDescriptors.csv')
biologAllGrowthDynamics <- inner_join(biologAllGrowthDynamics,Fig3_CarbonSourceDescriptors)
biologAllGrowthDynamics <- biologAllGrowthDynamics %>% arrange(description)
biologAllGrowthDynamics$carbonSource <- factor(biologAllGrowthDynamics$carbonSource, levels = rev(unique(biologAllGrowthDynamics$carbonSource)),ordered = TRUE)
Fig3A <- biologAllGrowthDynamics %>%
ggplot(aes(x=strain, y=carbonSource)) +
geom_tile(aes(fill = medianMaxOD600), color='white')+
xlab("")+ylab("")+theme_bw() +theme(axis.text.y = element_text(size=10), axis.text.x = element_text(angle = 45, hjust = 1), legend.position="top", legend.title=element_text(size=8)) + guides(fill = guide_colorbar(title.position = "top",title.hjust = 0.5, title = 'Max Growth \n (OD600)'))+
scale_fill_gradient(low = "grey95", high = "black")+
scale_x_discrete(breaks=c("Day0Anc","Day20C2","Day20F4","Day20P1","Day20T3"),
labels=c("Ancestor", "LBE", "CIP","PIP","TOB"))
# Figure 3B
Fig3B <- biologAllGrowthDynamics %>%
ggplot(aes(x=strain, y=carbonSource)) +
geom_tile(aes(fill = medianGrowthRate), color='white')+
xlab("")+ylab("")+theme_bw() +  theme(axis.text.y = element_blank(), legend.position="top", axis.text.x = element_text(angle = 45, hjust = 1), legend.title=element_text(size=8)) + guides(fill = guide_colorbar(title.position = "top",title.hjust = 0.5, title = 'Growth Rate \n (ln(OD600)/hr)',label.hjust=0.6))+
scale_fill_gradient(low = "grey95", high = "black")+
scale_x_discrete(breaks=c("Day0Anc","Day20C2","Day20F4","Day20P1","Day20T3"),
labels=c("Ancestor", "LBE", "CIP","PIP","TOB"))
# Figure 3C
Fig3C <- biologAllGrowthDynamics %>%
ggplot(aes(x=strain, y=carbonSource)) +
geom_tile(aes(fill = medianLagPhase), color='white')+
xlab("")+ylab("")+ theme_bw() +theme(axis.text.y = element_blank(), legend.position="top", axis.text.x = element_text(angle = 45, hjust = 1), legend.title=element_text(size=8)) +guides(fill = guide_colorbar( title.position = "top",title.hjust = 0.5, title = 'Time to Mid-Exp \n (hr)'))+
scale_fill_gradient(low = "grey95", high = "black", trans='log10')+
scale_x_discrete(breaks=c("Day0Anc","Day20C2","Day20F4","Day20P1","Day20T3"),
labels=c("Ancestor", "LBE", "CIP","PIP","TOB"))
# New 3D (medianMaxOD600)
Fig3D <- biologAllGrowthDynamics %>%
ggplot(aes(x=strain, y = medianMaxOD600))+
geom_boxplot(aes(color = strain), size=1.25) +
geom_signif(comparisons=list(c("Day0Anc", "Day20C2"), c("Day0Anc", "Day20F4"), c("Day0Anc","Day20P1")), annotations=c("**", "**","**"), tip_length = 0, y_position = c(0.52, 0.565,0.610))+
scale_colour_manual(values = c('grey','black','gold2','red','dodgerblue2'),breaks=c("Day0Anc",'Day20C2',"Day20F4","Day20P1","Day20T3"),labels=c("Ancestor","LBE","CIP","PIP","TOB"))+
theme_bw()+
theme(axis.text.y = element_text(size=10), axis.title.y=element_text(size=12),legend.position="bottom",legend.title=element_blank(), axis.text.x = element_blank())+xlab("")+ylim(0,0.62)+ylab('Max Growth (OD600)')
# Figure 3E
Fig3E <- biologAllGrowthDynamics %>%
ggplot(aes(x=strain, y = medianGrowthRate))+
geom_boxplot(aes(color = strain), size=1.25)+
geom_signif(comparisons=list(c("Day0Anc", "Day20F4"), c("Day0Anc","Day20P1"), c("Day0Anc","Day20T3")), annotations=c("***","***","**"), tip_length = 0, y_position = c(0.425, 0.465, 0.505))+
scale_colour_manual(values = c('grey','black','gold2','red','dodgerblue2'),breaks=c("Day0Anc",'Day20C2',"Day20F4","Day20P1","Day20T3"))+
theme_bw()+
theme(axis.text.y = element_text(size=10), axis.title.y=element_text(size=12),legend.position="none", axis.text.x = element_blank())+xlab("")+ylab('Growth Rate (ln(OD600)/hr)')+ylim(0,0.525)
# Figure 3F
Fig3F <- biologAllGrowthDynamics %>%
ggplot(aes(x=strain, y = medianLagPhase))+
geom_boxplot(aes(color = strain), size=1.25)+
geom_signif(comparisons=list(c("Day0Anc","Day20P1"), c("Day0Anc","Day20F4")), annotations = c('***','**'), tip_length = 0, y_position = c(1.95, 1.75))+
scale_colour_manual(values = c('grey','black','gold2','red','dodgerblue2'),breaks=c("Day0Anc",'Day20C2',"Day20F4","Day20P1","Day20T3"))+
theme_bw()+ scale_y_log10(limits=c(NA,100)) +
theme(axis.text.y = element_text(size=10), axis.title.y=element_text(size=12),legend.position="none", axis.text.x = element_blank())+xlab("")+ylab("Time to Mid-Exponential (hr)")
legend_3DEF <- get_legend(Fig3D)
```
```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=8.5, fig.width=7.5, fig.align='center'}
# Arrange, plot, and save Figure 3
# Need to do the below steps to get all subpanels to be the same widths
gA <- ggplotGrob(Fig3A+theme(axis.text.y = element_blank()))
gB <- ggplotGrob(Fig3B)
gC <- ggplotGrob(Fig3C)
gD <- ggplotGrob(Fig3D+theme(legend.position='none'))
gE <- ggplotGrob(Fig3E)
gF <- ggplotGrob(Fig3F)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5],gC$widths[2:5], gD$widths[2:5],gE$widths[2:5], gF$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth)
gB$widths[2:5] <- as.list(maxWidth)
gC$widths[2:5] <- as.list(maxWidth)
gD$widths[2:5] <- as.list(maxWidth)
gE$widths[2:5] <- as.list(maxWidth)
gF$widths[2:5] <- as.list(maxWidth)
# Labels for each row in Figures 3A-C
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.635),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.25,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.635),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.1,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.635),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(0.5,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.635),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(0.25,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.633),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(0.25,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.62),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(0.25,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.62),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(0,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(0,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.1,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.25,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.5,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.5,-1.5,1.5,-0.5),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.5,-1.5,2,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.5,-1.5,1.75,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.75,-1.5,1.5,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.75,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.6,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.65,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.55,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.53,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.52,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.50,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.45,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.40,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
carbonSourceLabels <- biologAllGrowthDynamics %>%
ungroup() %>%
select(carbonSource) %>%
unique() %>%
ggplot() +
geom_rect(aes(ymin = 1, ymax = length(carbonSource)*.8,xmin = 0.35, xmax = 0.5),fill='white')+
geom_text(aes(x=c(0.5),y=c((1:length(carbonSource))*0.6),label=rev(carbonSource),hjust=1))+
theme(axis.line.x=element_line(color='white'),axis.title.x=element_blank(),axis.title.y=element_blank(),axis.ticks=element_blank(),axis.line.y=element_line(color='white'),legend.position='none',plot.margin=unit(c(-0.35,-1.5,1.6,0),'cm'), axis.text.x=element_blank(),axis.text.y=element_blank())
# Arrange the subpanels
Fig3 <- arrangeGrob(gA, gB,gC,gD,gE,gF,legend_3DEF,carbonSourceLabels, ncol=4, nrow =3, heights=c(98, 52, 5), layout_matrix=cbind(c(8,NA,NA),c(1,4,7),c(2,5,7), c(3,6,7)))
Figure3 <- as_ggplot(Fig3) +                                # transform to a ggplot
draw_plot_label(label = c("A", "B", "C","D","E","F"), size = 15,
x = c(0.25, 0.5, .75, 0.25, 0.5,0.75), y = c(1, 1,1,0.4,0.4,0.4))
Figure3
ggsave('Figures and Data/Fig3.tiff',Figure3,height=8.5, width=7.5, units="in", dpi=300)
